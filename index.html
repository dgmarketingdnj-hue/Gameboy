<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tap Earn Game</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <!-- Monetag SDK - à¦†à¦ªà¦¨à¦¾à¦° à¦¡à§à¦¯à¦¾à¦¶à¦¬à§‹à¦°à§à¦¡ à¦¥à§‡à¦•à§‡ à¦šà§‡à¦• à¦•à¦°à§à¦¨ -->
    <script src="//libtl.com/sdk.js" data-zone="10362739" data-sdk="show_10362739" async></script>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; background: linear-gradient(#000, #001133); color: white; margin: 0; padding: 20px; overflow: hidden; }
        h1 { font-size: 28px; }
        #username { font-size: 20px; margin: 10px; color: gold; }
        #points { font-size: 40px; margin: 20px; }
        #tap-area { position: relative; width: 250px; height: 250px; margin: 40px auto; }
        #tap-button { 
            width: 200px; height: 200px; background: transparent; border: none; cursor: pointer; 
            font-size: 150px; animation: pulse 2s infinite; 
        }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }
        #tap-button:active { transform: scale(0.9); animation: none; }
        button { padding: 12px 24px; font-size: 18px; margin: 10px; background: #007bff; color: white; border: none; border-radius: 10px; cursor: pointer; }
        button:hover { background: #0056b3; }
        .floating-text { position: absolute; font-size: 30px; font-weight: bold; color: gold; pointer-events: none; animation: floatUp 1s ease-out forwards; }
        @keyframes floatUp { 0% { opacity: 1; transform: translateY(0); } 100% { opacity: 0; transform: translateY(-100px); } }
        #sound-toggle { background: #28a745; }
        #spin-modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 1000; justify-content: center; align-items: center; }
        /* à¦¬à¦¾à¦•à¦¿ à¦¸à§à¦ªà¦¿à¦¨ à¦¸à§à¦Ÿà¦¾à¦‡à¦² à¦†à¦—à§‡à¦° à¦®à¦¤à§‹ */
        #wheel-container { width: 320px; background: #111; border-radius: 20px; padding: 20px; }
        #wheel-pointer { position: absolute; top: -15px; left: 50%; transform: translateX(-50%); font-size: 50px; z-index: 10; }
        #result { margin-top: 20px; font-size: 28px; color: lime; font-weight: bold; }
        .confetti { position: absolute; width: 10px; height: 10px; background: gold; pointer-events: none; animation: confetti-fall 3s linear forwards; }
        @keyframes confetti-fall { 0% { transform: translateY(-100vh) rotate(0deg); opacity: 1; } 100% { transform: translateY(100vh) rotate(720deg); opacity: 0; } }
    </style>
</head>
<body>
    <h1>ğŸš€ Tap to Earn Points! ğŸš€</h1>
    <div id="username">Welcome!</div>
    <div id="points">Points: 0</div>
    
    <div id="tap-area">
        <button id="tap-button">ğŸª™</button>
    </div>
    
    <button id="sound-toggle" onclick="toggleSound()">ğŸ”Š Sound ON</button>
    <br>
    <button onclick="watchRewardedAd()">ğŸ“º Watch Ad +300 Points</button>
    <button onclick="dailyReward()">ğŸ Daily Bonus</button>
    <button onclick="showReferral()">ğŸ‘¥ Invite Friends</button>
    <button onclick="spinToWin()">ğŸ¡ Spin to Win</button>

    <!-- Spin Modal -->
    <div id="spin-modal">
        <div id="wheel-container">
            <div id="wheel-pointer">ğŸ¯</div>
            <canvas id="wheel" width="300" height="300"></canvas>
            <button id="spin-btn" onclick="startSpin()">SPIN!</button>
            <div id="result"></div>
            <button onclick="closeSpinModal()">Close</button>
        </div>
    </div>

    <script>
        // Sounds (free royalty-free links)
        const tapSound = new Audio('https://cdn.freesound.org/previews/654/654541_5674468-lq.mp3'); // coin collect
        const spinTickSound = new Audio('https://freesound.org/data/previews/244/244774_4419067-lq.mp3'); // wheel tick
        const winSound = new Audio('https://mixkit.co/free-sound-effects/win/'); // confetti celebration (example, change if needed)

        let soundEnabled = localStorage.getItem('soundEnabled') !== 'false'; // default ON
        updateSoundToggle();

        function toggleSound() {
            soundEnabled = !soundEnabled;
            localStorage.setItem('soundEnabled', soundEnabled);
            updateSoundToggle();
        }

        function updateSoundToggle() {
            document.getElementById('sound-toggle').innerText = soundEnabled ? 'ğŸ”Š Sound ON' : 'ğŸ”‡ Sound OFF';
        }

        function playSound(audio) {
            if (soundEnabled) {
                audio.currentTime = 0;
                audio.play().catch(() => {}); // mute error ignore
            }
        }

        let points = parseInt(localStorage.getItem('points') || '0');
        const pointsDisplay = document.getElementById('points');
        const usernameDisplay = document.getElementById('username');
        const tapButton = document.getElementById('tap-button');

        if (window.Telegram && Telegram.WebApp) {
            Telegram.WebApp.ready();
            Telegram.WebApp.expand();
            const user = Telegram.WebApp.initDataUnsafe.user;
            if (user) usernameDisplay.innerText = `Welcome, ${user.first_name}! ğŸ‘‹`;
        }

        function updatePoints() {
            pointsDisplay.innerText = `Points: ${points.toLocaleString()}`;
            localStorage.setItem('points', points);
        }

        // Enhanced Tap Animation with +points floating
        tapButton.addEventListener('click', function(e) {
            points += 20;
            updatePoints();
            playSound(tapSound);

            // Floating +20 text
            const floatText = document.createElement('div');
            floatText.className = 'floating-text';
            floatText.innerText = '+20';
            floatText.style.left = `${e.pageX - 30}px`;
            floatText.style.top = `${e.pageY - 50}px`;
            document.body.appendChild(floatText);
            setTimeout(() => floatText.remove(), 1000);
        });

        // Monetag Ad (à¦†à¦ªà¦¨à¦¾à¦° zone ID à¦¦à¦¿à¦¯à¦¼à§‡)
        function watchRewardedAd() {
            const showAd = window.show_10362739;
            if (typeof showAd !== 'function') return alert("Ad loading...");
            showAd().then(() => {
                points += 300;
                updatePoints();
                alert("Ad watched! +300 Points ğŸ‰");
            }).catch(() => alert("Ad closed early ğŸ˜”"));
        }

        // à¦¬à¦¾à¦•à¦¿ à¦«à¦¿à¦šà¦¾à¦° (daily, referral, spin) à¦†à¦—à§‡à¦° à¦®à¦¤à§‹ à¦°à¦¾à¦–à§à¦¨ â€“ à¦¸à§à¦ªà¦¿à¦¨à§‡ playSound(spinTickSound); à¦à¦¬à¦‚ à¦œà¦¯à¦¼à§‡ playSound(winSound);

        updatePoints();
    </script>
</body>
</html>
